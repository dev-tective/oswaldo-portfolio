---
import { Icon } from 'astro-icon/components'

const github = "https://github.com/dev-tective";
const linkedin = "https://pe.linkedin.com/in/oswaldo-natanael-magui%C3%B1o-soto-285142345";

const menu = [
    {
        title: "Redes",
        options: [
            { href: github, icon: "GitHub", text: "GitHub" },
            { href: linkedin, icon: "LinkedIn", text: "LinkedIn" },
        ]
    },
    {
        title: "Secciones",
        options: [
            { href: "", icon: "Arrow", text: "Sobre Mí" },
            { href: "", icon: "Arrow", text: "Formación" },
            { href: "", icon: "Arrow", text: "Proyectos" },
            { href: "", icon: "Arrow", text: "Experiencia" },
            { href: "", icon: "Arrow", text: "Contacto" },
        ]
    }
]

const play = { title: "Reproducir", icon: "Play" };
const pause = { title: "Pausar", icon: "Paused" };

const prev = { icon: "Prev", title: "Anterior" };
const next = { icon: "Next", title: "Siguiente" };
const song = { icon: "Song", title: "Canción" };
const min = { icon: "Min", title: "Mínimo" };
const max = { icon: "Max", title: "Máximo" };
---

<audio id="bg-music" preload="metadata" />

<header class="w-full h-[11vh] fixed top-0 z-30 content-center">
    <div class="h-4/5 w-11/12 m-auto flex justify-between items-center">
        <button class="option" id="btn-control">
            <Icon class="icon icon-play" name={play.icon} title={play.title} />
            <Icon class="icon icon-pause hidden" name={pause.icon} title={pause.title} />
        </button>
        <button class="option" id="btn-menu">
            <Icon class="icon" name={"Menu"} title='Menu' />
        </button>
    </div>
</header>

<aside id="menu" class="text-white flex flex-col justify-start items-center gap-7 py-7">
    {menu.map(({ title, options }) => (
        <div class="w-10/12 flex flex-col gap-3">
            <h2 class="text-start text-xl font-bold">{title}</h2>
            {options.map(({ href, text, icon }) => (
                    <a class="option-menu bg-cyan-900 aspect-[2/0.4] justify-between items-center
                    px-3 transition-normal duration-300 hover:bg-cyan-700"
                       href={href}
                       target="_blank"
                    >
                        {text}
                        <Icon class={"text-4xl"}
                              name={icon}
                              title={text}
                        />
                    </a>
            ))}
        </div>
    ))}
    <div class="w-10/12 flex flex-col gap-3">
        <h2 class="w-full text-start text-xl font-bold">Musica</h2>
        <div class="flex flex-col gap-5 text-3xl bg-cyan-900 p-4 option-menu">
            <div class="flex items-center justify-start gap-3">
                <Icon class="text-2xl flex-shrink-0" name={song.icon} title={song.title} />
                <p id="music-title" class="text-sm whitespace-nowrap overflow-hidden text-ellipsis w-72">Cargando...</p>
            </div>
            <div class="flex items-center justify-between">
                <Icon id={'icon-prev'} class={'option-music'} name={prev.icon} title={prev.title} />
                <Icon class={'icon-play option-music'} name={play.icon} title={play.title} />
                <Icon class={'icon-pause hidden option-music'} name={pause.icon} title={pause.title} />
                <Icon id={'icon-next'} class={'option-music'} name={next.icon} title={next.title} />
            </div>
        </div>
    </div>
</aside>
<div id="player" class="hidden" />
<div class="fixed w-full h-full bg-white/2 backdrop-blur-md blur-overlay" />

<style>
    @reference "tailwindcss";

    .option {
        @apply content-center h-4/5 relative aspect-[2.2/1] bg-white cursor-pointer;
        clip-path: polygon(
                13px 0%,
                100% 0%,
                100% calc(100% - 13px),
                calc(100% - 13px) 100%,
                0% 100%,
                0% 13px
        );
    }

    .option::before {
        @apply absolute top-1 left-1 bottom-1 right-1 z-[-1] bg-cyan-800 transition duration-300;
        content: "";
        clip-path: polygon(
                10px 0%,
                100% 0%,
                100% calc(100% - 10px),
                calc(100% - 10px) 100%,
                0% 100%,
                0% 10px
        );
    }

    .option:hover::before {
        @apply bg-cyan-600;
    }

    .icon {
        @apply text-white w-full h-3/5;
    }

    aside {
        @apply fixed -right-full z-50 h-full w-[clamp(300px,70vw,450px)] overflow-y-auto transition-normal duration-400;
        background: repeating-linear-gradient(
                to top,
                rgba(77, 147, 187, 0.05),
                rgba(77, 147, 187, 0.05) 1.5px,
                transparent 1px,
                transparent 2px
        ), linear-gradient(
                to right,
                #082237,
                #060C13
        );
    }

    aside::-webkit-scrollbar {
        width: 5px;
        border-radius: 0;
    }
    aside::-webkit-scrollbar-track {
        @apply bg-cyan-950;
        border-radius: 0;
    }

    aside::-webkit-scrollbar-thumb {
        @apply bg-lime-400;
        border-radius: 0;
        border: 0;
    }
    aside::-webkit-scrollbar-thumb:hover {
        @apply bg-lime-300;
    }
    aside::-webkit-scrollbar-button {
        display: none;
    }
    aside.active {
        @apply right-0;
    }

    div.blur-overlay {
        z-index: -10;
    }
    aside.active ~ div.blur-overlay {
        z-index: 40;
    }

    .option-menu {
        @apply relative border-l-5 border-l-lime-400 flex;
    }
    .option-menu::after {
        @apply absolute left-0 bottom-0 w-full bg-white;
        content: "";
        height: 2px;
    }
    
    .option-music {
        @apply transition-normal duration-200;
    }
    .option-music:hover {
        @apply text-cyan-200;
    }
</style>

<script>
    import "./scripts/music"
    import "./scripts/menu"
</script>